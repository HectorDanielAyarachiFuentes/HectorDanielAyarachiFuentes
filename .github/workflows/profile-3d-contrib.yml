name: GitHub-Profile-3D-Contrib

on:
  schedule:
    - cron: '0 0 * * *'  # Todos los días a la medianoche
  workflow_dispatch:      # Permite ejecutarlo manualmente desde GitHub

jobs:
  generate-3d-contrib:
    runs-on: ubuntu-latest
    name: Generar gráfico 3D de contribuciones

    steps:
      - uses: actions/checkout@v4

      - name: Ejecutar generador 3D (fork de yoshi389111)
        uses: yoshi389111/github-profile-3d-contrib@main
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          USERNAME: ${{ github.repository_owner }}
          THEME: tokyonight

      - name: Verificar que la imagen fue generada
        run: |
          if [ ! -f "profile-3d-contrib/profile-tokyonight.svg" ]; then
            echo "El archivo de imagen 3D no fue generado. El workflow fallará para que puedas investigarlo."
            exit 1
          fi

      - name: Commit & Push de la imagen 3D
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "Chore: Actualizar imagen 3D de contribuciones"
          file_pattern: profile-3d-contrib/profile-tokyonight.svg
